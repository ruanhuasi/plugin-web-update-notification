"use strict";var gt=Object.create;var I=Object.defineProperty;var mt=Object.getOwnPropertyDescriptor;var yt=Object.getOwnPropertyNames;var xt=Object.getPrototypeOf,wt=Object.prototype.hasOwnProperty;var _t=(t,s,e)=>s in t?I(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var F=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports),vt=(t,s)=>{for(var e in s)I(t,e,{get:s[e],enumerable:!0})},q=(t,s,e,p)=>{if(s&&typeof s=="object"||typeof s=="function")for(let a of yt(s))!wt.call(t,a)&&a!==e&&I(t,a,{get:()=>s[a],enumerable:!(p=mt(s,a))||p.enumerable});return t};var S=(t,s,e)=>(e=t!=null?gt(xt(t)):{},q(s||!t||!t.__esModule?I(e,"default",{value:t,enumerable:!0}):e,t)),Tt=t=>q(I({},"__esModule",{value:!0}),t);var V=(t,s,e)=>(_t(t,typeof s!="symbol"?s+"":s,e),e),D=(t,s,e)=>{if(!s.has(t))throw TypeError("Cannot "+e)};var _=(t,s,e)=>(D(t,s,"read from private field"),e?e.call(t):s.get(t)),b=(t,s,e)=>{if(s.has(t))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(t):s.set(t,e)},w=(t,s,e,p)=>(D(t,s,"write to private field"),p?p.call(t,e):s.set(t,e),e),C=(t,s,e,p)=>({set _(a){w(t,s,a,e)},get _(){return _(t,s,p)}});var W=F((he,j)=>{(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s={rotl:function(e,p){return e<<p|e>>>32-p},rotr:function(e,p){return e<<32-p|e>>>p},endian:function(e){if(e.constructor==Number)return s.rotl(e,8)&16711935|s.rotl(e,24)&4278255360;for(var p=0;p<e.length;p++)e[p]=s.endian(e[p]);return e},randomBytes:function(e){for(var p=[];e>0;e--)p.push(Math.floor(Math.random()*256));return p},bytesToWords:function(e){for(var p=[],a=0,f=0;a<e.length;a++,f+=8)p[f>>>5]|=e[a]<<24-f%32;return p},wordsToBytes:function(e){for(var p=[],a=0;a<e.length*32;a+=8)p.push(e[a>>>5]>>>24-a%32&255);return p},bytesToHex:function(e){for(var p=[],a=0;a<e.length;a++)p.push((e[a]>>>4).toString(16)),p.push((e[a]&15).toString(16));return p.join("")},hexToBytes:function(e){for(var p=[],a=0;a<e.length;a+=2)p.push(parseInt(e.substr(a,2),16));return p},bytesToBase64:function(e){for(var p=[],a=0;a<e.length;a+=3)for(var f=e[a]<<16|e[a+1]<<8|e[a+2],l=0;l<4;l++)a*8+l*6<=e.length*8?p.push(t.charAt(f>>>6*(3-l)&63)):p.push("=");return p.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var p=[],a=0,f=0;a<e.length;f=++a%4)f!=0&&p.push((t.indexOf(e.charAt(a-1))&Math.pow(2,-2*f+8)-1)<<f*2|t.indexOf(e.charAt(a))>>>6-f*2);return p}};j.exports=s})()});var M=F((de,Q)=>{var L={utf8:{stringToBytes:function(t){return L.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(L.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var s=[],e=0;e<t.length;e++)s.push(t.charCodeAt(e)&255);return s},bytesToString:function(t){for(var s=[],e=0;e<t.length;e++)s.push(String.fromCharCode(t[e]));return s.join("")}}};Q.exports=L});var K=F((ge,Z)=>{Z.exports=function(t){return t!=null&&(X(t)||At(t)||!!t._isBuffer)};function X(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function At(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&X(t.slice(0,0))}});var et=F((me,tt)=>{(function(){var t=W(),s=M().utf8,e=K(),p=M().bin,a=function(f,l){f.constructor==String?l&&l.encoding==="binary"?f=p.stringToBytes(f):f=s.stringToBytes(f):e(f)?f=Array.prototype.slice.call(f,0):!Array.isArray(f)&&f.constructor!==Uint8Array&&(f=f.toString());for(var c=t.bytesToWords(f),h=f.length*8,r=1732584193,n=-271733879,i=-1732584194,o=271733878,u=0;u<c.length;u++)c[u]=(c[u]<<8|c[u]>>>24)&16711935|(c[u]<<24|c[u]>>>8)&4278255360;c[h>>>5]|=128<<h%32,c[(h+64>>>9<<4)+14]=h;for(var d=a._ff,g=a._gg,m=a._hh,y=a._ii,u=0;u<c.length;u+=16){var ft=r,lt=n,ht=i,dt=o;r=d(r,n,i,o,c[u+0],7,-680876936),o=d(o,r,n,i,c[u+1],12,-389564586),i=d(i,o,r,n,c[u+2],17,606105819),n=d(n,i,o,r,c[u+3],22,-1044525330),r=d(r,n,i,o,c[u+4],7,-176418897),o=d(o,r,n,i,c[u+5],12,1200080426),i=d(i,o,r,n,c[u+6],17,-1473231341),n=d(n,i,o,r,c[u+7],22,-45705983),r=d(r,n,i,o,c[u+8],7,1770035416),o=d(o,r,n,i,c[u+9],12,-1958414417),i=d(i,o,r,n,c[u+10],17,-42063),n=d(n,i,o,r,c[u+11],22,-1990404162),r=d(r,n,i,o,c[u+12],7,1804603682),o=d(o,r,n,i,c[u+13],12,-40341101),i=d(i,o,r,n,c[u+14],17,-1502002290),n=d(n,i,o,r,c[u+15],22,1236535329),r=g(r,n,i,o,c[u+1],5,-165796510),o=g(o,r,n,i,c[u+6],9,-1069501632),i=g(i,o,r,n,c[u+11],14,643717713),n=g(n,i,o,r,c[u+0],20,-373897302),r=g(r,n,i,o,c[u+5],5,-701558691),o=g(o,r,n,i,c[u+10],9,38016083),i=g(i,o,r,n,c[u+15],14,-660478335),n=g(n,i,o,r,c[u+4],20,-405537848),r=g(r,n,i,o,c[u+9],5,568446438),o=g(o,r,n,i,c[u+14],9,-1019803690),i=g(i,o,r,n,c[u+3],14,-187363961),n=g(n,i,o,r,c[u+8],20,1163531501),r=g(r,n,i,o,c[u+13],5,-1444681467),o=g(o,r,n,i,c[u+2],9,-51403784),i=g(i,o,r,n,c[u+7],14,1735328473),n=g(n,i,o,r,c[u+12],20,-1926607734),r=m(r,n,i,o,c[u+5],4,-378558),o=m(o,r,n,i,c[u+8],11,-2022574463),i=m(i,o,r,n,c[u+11],16,1839030562),n=m(n,i,o,r,c[u+14],23,-35309556),r=m(r,n,i,o,c[u+1],4,-1530992060),o=m(o,r,n,i,c[u+4],11,1272893353),i=m(i,o,r,n,c[u+7],16,-155497632),n=m(n,i,o,r,c[u+10],23,-1094730640),r=m(r,n,i,o,c[u+13],4,681279174),o=m(o,r,n,i,c[u+0],11,-358537222),i=m(i,o,r,n,c[u+3],16,-722521979),n=m(n,i,o,r,c[u+6],23,76029189),r=m(r,n,i,o,c[u+9],4,-640364487),o=m(o,r,n,i,c[u+12],11,-421815835),i=m(i,o,r,n,c[u+15],16,530742520),n=m(n,i,o,r,c[u+2],23,-995338651),r=y(r,n,i,o,c[u+0],6,-198630844),o=y(o,r,n,i,c[u+7],10,1126891415),i=y(i,o,r,n,c[u+14],15,-1416354905),n=y(n,i,o,r,c[u+5],21,-57434055),r=y(r,n,i,o,c[u+12],6,1700485571),o=y(o,r,n,i,c[u+3],10,-1894986606),i=y(i,o,r,n,c[u+10],15,-1051523),n=y(n,i,o,r,c[u+1],21,-2054922799),r=y(r,n,i,o,c[u+8],6,1873313359),o=y(o,r,n,i,c[u+15],10,-30611744),i=y(i,o,r,n,c[u+6],15,-1560198380),n=y(n,i,o,r,c[u+13],21,1309151649),r=y(r,n,i,o,c[u+4],6,-145523070),o=y(o,r,n,i,c[u+11],10,-1120210379),i=y(i,o,r,n,c[u+2],15,718787259),n=y(n,i,o,r,c[u+9],21,-343485551),r=r+ft>>>0,n=n+lt>>>0,i=i+ht>>>0,o=o+dt>>>0}return t.endian([r,n,i,o])};a._ff=function(f,l,c,h,r,n,i){var o=f+(l&c|~l&h)+(r>>>0)+i;return(o<<n|o>>>32-n)+l},a._gg=function(f,l,c,h,r,n,i){var o=f+(l&h|c&~h)+(r>>>0)+i;return(o<<n|o>>>32-n)+l},a._hh=function(f,l,c,h,r,n,i){var o=f+(l^c^h)+(r>>>0)+i;return(o<<n|o>>>32-n)+l},a._ii=function(f,l,c,h,r,n,i){var o=f+(c^(l|~h))+(r>>>0)+i;return(o<<n|o>>>32-n)+l},a._blocksize=16,a._digestsize=16,tt.exports=function(f,l){if(f==null)throw new Error("Illegal argument "+f);var c=t.wordsToBytes(a(f,l));return l&&l.asBytes?c:l&&l.asString?p.bytesToString(c):t.bytesToHex(c)}})()});var jt={};vt(jt,{CUSTOM_UPDATE_EVENT_NAME:()=>Rt,DIRECTORY_NAME:()=>Vt,INJECT_SCRIPT_FILE_NAME:()=>kt,INJECT_STYLE_FILE_NAME:()=>Ot,JSON_FILE_NAME:()=>Ct,LOCAL_STORAGE_PREFIX:()=>Bt,NOTIFICATION_ANCHOR_CLASS_NAME:()=>Lt,NOTIFICATION_DISMISS_BTN_CLASS_NAME:()=>Ut,NOTIFICATION_POSITION_MAP:()=>qt,NOTIFICATION_REFRESH_BTN_CLASS_NAME:()=>Mt,generateJSONFileContent:()=>zt,generateJsFileContent:()=>Yt,getCustomVersion:()=>at,getFileHash:()=>Gt,getGitCommitHash:()=>ct,getHostProjectPkgVersion:()=>st,getSVNRevisionNumber:()=>ut,getTimestamp:()=>P,getVersion:()=>$t,get__Dirname:()=>Ht,logVersionDefault:()=>pt,pkgName:()=>Dt});module.exports=Tt(jt);var nt=require("path"),ot=require("url"),B=require("child_process");var N=S(require("path"),1),Y=require("url");var H=S(require("process"),1),G=S(require("path"),1),A=S(require("fs"),1),J=require("url");var O=class{constructor(s){V(this,"value");V(this,"next");this.value=s}},x,v,T,E=class{constructor(){b(this,x,void 0);b(this,v,void 0);b(this,T,void 0);this.clear()}enqueue(s){let e=new O(s);_(this,x)?(_(this,v).next=e,w(this,v,e)):(w(this,x,e),w(this,v,e)),C(this,T)._++}dequeue(){let s=_(this,x);if(s)return w(this,x,_(this,x).next),C(this,T)._--,s.value}clear(){w(this,x,void 0),w(this,v,void 0),w(this,T,0)}get size(){return _(this,T)}*[Symbol.iterator](){let s=_(this,x);for(;s;)yield s.value,s=s.next}};x=new WeakMap,v=new WeakMap,T=new WeakMap;var $={directory:"isDirectory",file:"isFile"};function St(t){if(!Object.hasOwnProperty.call($,t))throw new Error(`Invalid type specified: ${t}`)}var It=(t,s)=>s[$[t]](),Nt=t=>t instanceof URL?(0,J.fileURLToPath)(t):t;function k(t,{cwd:s=H.default.cwd(),type:e="file",allowSymlinks:p=!0}={}){St(e),s=Nt(s);let a=p?A.default.statSync:A.default.lstatSync;for(let f of t)try{let l=a(G.default.resolve(s,f),{throwIfNoEntry:!1});if(!l)continue;if(It(e,l))return f}catch{}}var z=S(require("fs"),1);var Ft=t=>t instanceof URL?(0,Y.fileURLToPath)(t):t,bt=Symbol("findUpStop");function Et(t,s={}){let e=N.default.resolve(Ft(s.cwd)||""),{root:p}=N.default.parse(e),a=s.stopAt||p,f=s.limit||Number.POSITIVE_INFINITY,l=[t].flat(),c=r=>{if(typeof t!="function")return k(l,r);let n=t(r.cwd);return typeof n=="string"?k([n],r):n},h=[];for(;;){let r=c({...s,cwd:e});if(r===bt||(r&&h.push(N.default.resolve(e,r)),e===a||h.length>=f))break;e=N.default.dirname(e)}return h}function R(t,s={}){return Et(t,{...s,limit:1})[0]}var it=S(et(),1);var rt="@plugin-ofs-web-update-notification/core";var Vt="pluginWebUpdateNotice",Ct="web_version_by_plugin",Ot="webUpdateNoticeInjectStyle",kt="webUpdateNoticeInjectScript.global",Rt="plugin_web_update_notice",Lt="plugin-web-update-notice-anchor",Mt="plugin-web-update-notice-refresh-btn",Ut="plugin-web-update-notice-dismiss-btn",Bt="web_update_check_dismiss_version_",qt={topLeft:"top: 24px;left: 24px",topRight:"top: 24px;right: 24px",bottomLeft:"bottom: 24px;left: 24px",bottomRight:"bottom: 24px;right: 24px"};var U={},Dt=rt;function Ht(){try{return U&&U.url?(0,nt.dirname)((0,ot.fileURLToPath)(U.url)):__dirname}catch{return __dirname}}function Gt(t){return(0,it.default)(t).slice(0,8)}function Jt(){return R(".git",{type:"directory"})?"Git":R(".svn",{type:"directory"})?"SVN":"unknown"}function st(){try{return process.env.npm_package_version}catch(t){throw console.warn(`
======================================================
[plugin-web-update-notice] cannot get the version of the host project's package.json file!
======================================================`),t}}function ct(){try{return(0,B.execSync)("git rev-parse --short HEAD").toString().replace(`
`,"").trim()}catch(t){throw console.warn(`
======================================================
[plugin-web-update-notice] Not a git repository!
======================================================`),t}}function ut(){try{return(0,B.execSync)("svnversion").toString().replace(`
`,"").trim()}catch(t){throw console.warn(`
======================================================
[plugin-web-update-notice] Not a SVN repository!
======================================================`),t}}function P(){return`${Date.now()}`}function at(t){if(!t)throw console.warn(`
======================================================
[plugin-web-update-notice] The versionType is 'custom', but the customVersion is not specified!
======================================================`),new Error("The versionType is 'custom', but the customVersion is not specified!");return t}function $t(t,s){let e={pkg_version:st,git_commit_hash:ct,build_timestamp:P,custom:()=>at(s),svn_revision_number:ut},a=t||{Git:"git_commit_hash",SVN:"svn_revision_number",unknown:""}[Jt()];try{let f=e[a];return f?f():(console.warn(`
      ======================================================
      [plugin-web-update-notice] The version type '${t}' is not supported!, we will use the packaging timestamp instead.
      ======================================================`),P())}catch(f){return console.warn(`
======================================================
[plugin-web-update-notice] get version throw a error, we will use the packaging timestamp instead.
======================================================`),console.error(f),P()}}function zt(t,s=!1){let e={version:t};return s&&(e.silence=!0),JSON.stringify(e,null,2)}function Yt(t,s,e){let{logVersion:p=!0}=e,a=`${t}
  window.__checkUpdateSetup__(${JSON.stringify(e)});`;return p&&(a+=`
      ;const logFn = ${(typeof p=="function"?p:pt).toString()}
      ;logFn('${s}', ${Date.now()})
    `),a}function pt(t,s){console.log(`version: %c${t}`,"color: #1677ff"),console.log(`release time: %c${new Date(s).toLocaleString()}`,"color: #1677ff")}0&&(module.exports={CUSTOM_UPDATE_EVENT_NAME,DIRECTORY_NAME,INJECT_SCRIPT_FILE_NAME,INJECT_STYLE_FILE_NAME,JSON_FILE_NAME,LOCAL_STORAGE_PREFIX,NOTIFICATION_ANCHOR_CLASS_NAME,NOTIFICATION_DISMISS_BTN_CLASS_NAME,NOTIFICATION_POSITION_MAP,NOTIFICATION_REFRESH_BTN_CLASS_NAME,generateJSONFileContent,generateJsFileContent,getCustomVersion,getFileHash,getGitCommitHash,getHostProjectPkgVersion,getSVNRevisionNumber,getTimestamp,getVersion,get__Dirname,logVersionDefault,pkgName});
/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
//# sourceMappingURL=index.cjs.map