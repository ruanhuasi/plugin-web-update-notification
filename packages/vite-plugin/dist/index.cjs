"use strict";var p=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var v=(t,s)=>{for(var r in s)p(t,r,{get:s[r],enumerable:!0})},y=(t,s,r,a)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of F(s))!_.call(t,o)&&o!==r&&p(t,o,{get:()=>s[o],enumerable:!(a=N(s,o))||a.enumerable});return t};var C=t=>y(p({},"__esModule",{value:!0}),t);var S={};v(S,{webUpdateNotice:()=>E});module.exports=C(S);var g=require("fs"),m=require("path"),e=require("@plugin-ofs-web-update-notification/core");function $(t,s,r,{cssFileHash:a,jsFileHash:o}){let{customNotificationHTML:n,hiddenDefaultNotification:c,injectFileBase:l=""}=r,d=`<script>window.pluginWebUpdateNotice_version = '${s}';</script>`,f=n||c?"":`<link rel="stylesheet" href="${l}${e.DIRECTORY_NAME}/${e.INJECT_STYLE_FILE_NAME}.${a}.css">`,i=t;return i=i.replace("<head>",`<head>
    ${f}
    <script src="${l}${e.DIRECTORY_NAME}/${e.INJECT_SCRIPT_FILE_NAME}.${o}.js"></script>
    ${d}`),c||(i=i.replace("</body>",`<div class="${e.NOTIFICATION_ANCHOR_CLASS_NAME}"></div></body>`)),i}function E(t={}){let s,{versionType:r,customVersion:a,silence:o}=t,n="";r==="custom"?n=(0,e.getVersion)(r,a):n=(0,e.getVersion)(r);let c="",l="",d=(0,g.readFileSync)(`${(0,m.resolve)((0,e.get__Dirname)(),e.INJECT_STYLE_FILE_NAME)}.css`,"utf8").toString();l=(0,e.getFileHash)(d);let f="";return{name:"vue-vite-web-update-notice",apply:"build",enforce:"post",async configResolved(i){s=i,t.injectFileBase===void 0&&(t.injectFileBase=s.base),f=(0,e.generateJsFileContent)((0,g.readFileSync)(`${(0,m.resolve)((0,e.get__Dirname)(),e.INJECT_SCRIPT_FILE_NAME)}.js`,"utf8").toString(),n,t),c=(0,e.getFileHash)(f)},generateBundle(i,u={}){n&&(u[e.JSON_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:(0,e.generateJSONFileContent)(n,o),fileName:`${e.DIRECTORY_NAME}/${e.JSON_FILE_NAME}.json`},u[e.INJECT_STYLE_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:d,fileName:`${e.DIRECTORY_NAME}/${e.INJECT_STYLE_FILE_NAME}.${l}.css`},u[e.INJECT_SCRIPT_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:f,fileName:`${e.DIRECTORY_NAME}/${e.INJECT_SCRIPT_FILE_NAME}.${c}.js`})},transformIndexHtml:{order:"post",handler(i,{chunk:u}){return n&&u?$(i,n,t,{jsFileHash:c,cssFileHash:l}):i},enforce:"post",async transform(i){return n?$(i,n,t,{jsFileHash:c,cssFileHash:l}):i}}}}0&&(module.exports={webUpdateNotice});
//# sourceMappingURL=index.cjs.map